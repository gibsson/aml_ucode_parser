commit 5739dda4f95dcb3ba242419b0368eb47a1091441
Author: shihong.zheng <shihong.zheng@amlogic.com>
Date:   Fri Mar 22 14:46:23 2019 +0800

    amstream: adjust vdec connect timming. [1/1]
    
    PD#SWPL-5888
    
    Problem:
    too many vdec_sync_input error print.
    
    Solution:
    1. remove vdec_connect befer other hw initial.
    2. vdec_disconnect before parser wp/rp reset in tsdemux.
    
    Verify:
    x301
    
    Change-Id: I7b8909496918a581d48a09deefad58cb1ce0e0f4
    Signed-off-by: shihong.zheng <shihong.zheng@amlogic.com>

diff --git a/drivers/stream_input/amports/amstream.c b/drivers/stream_input/amports/amstream.c
index c3c3095..a1b4a47 100644
--- a/drivers/stream_input/amports/amstream.c
+++ b/drivers/stream_input/amports/amstream.c
@@ -685,8 +685,6 @@ static int video_port_init(struct port_priv_s *priv,
 
 	pbuf->flag |= BUF_FLAG_IN_USE;
 
-	vdec_connect(priv->vdec);
-
 	return 0;
 }
 
@@ -1031,6 +1029,7 @@ static int amstream_port_release(struct port_priv_s *priv)
 	}
 
 	if (port->type & PORT_TYPE_MPTS) {
+		vdec_disconnect(priv->vdec);
 		tsync_pcr_stop();
 		tsdemux_release();
 	}

commit b7fa8c54fc559341cb2bb260c31ec3ffef9d1e5f
Author: rongrong zhou <rongrong.zhou@amlogic.com>
Date:   Wed Feb 13 10:17:59 2019 +0800

    mh264: 8k h264 mmubox allocation check [1/1]
    
    PD#SWPL-4719
    
    Problem:
        8k h264 crash
    
    Solution:
        we do not support 8k h264, no need to enlarge MAX_FRAME_4K_NUM to match 8K,
        if cur_mmu_4k_number > MAX_FRAME_4K_NUM, return error
    
    Verify:
        Verified x301
    
    Change-Id: I1fb1d19a472cc00b0052cbe347b0e7541c99adac

diff --git a/drivers/frame_provider/decoder/h264_multi/vmh264.c b/drivers/frame_provider/decoder/h264_multi/vmh264.c
index e6c8441..15b5010 100644
--- a/drivers/frame_provider/decoder/h264_multi/vmh264.c
+++ b/drivers/frame_provider/decoder/h264_multi/vmh264.c
@@ -911,6 +911,13 @@ static int hevc_alloc_mmu(struct vdec_h264_hw_s *hw, int pic_idx,
 		PRINT_FLAG_MMU_DETAIL,
 		"alloc_mmu new_fb_idx %d picture_size %d cur_mmu_4k_number %d\n",
 		cur_buf_idx, picture_size, cur_mmu_4k_number);
+
+	if (cur_mmu_4k_number > MAX_FRAME_4K_NUM) {
+		pr_err("hevc_alloc_mmu cur_mmu_4k_number %d unsupport\n",
+		cur_mmu_4k_number);
+		return -1;
+	}
+
 	return decoder_mmu_box_alloc_idx(
 	hw->mmu_box,
 	cur_buf_idx,

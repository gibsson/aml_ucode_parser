commit 85c5e7aa6c93eb86f212f353c32fa41822995bb5
Author: Hui Zhang <hui.zhang@amlogic.com>
Date:   Wed Jun 5 14:53:46 2019 +0800

    vmh264: fix invalid resolution  in pool signal caused too much printf issue [1/1]
    
    PD#SWPL-9391
    
    Problem:
    too many error print in invalid resolution in poor signal.
    it caused system dead.
    
    Solution:
    skip error nal when invalid resolution happen. search next start
    code.
    
    Verify:
    x301
    
    Change-Id: Ib5dd280fd36e0b1d963a31e4d2a2633ddf6ff7d4
    Signed-off-by: Hui Zhang <hui.zhang@amlogic.com>

diff --git a/drivers/frame_provider/decoder/h264_multi/vmh264.c b/drivers/frame_provider/decoder/h264_multi/vmh264.c
index 552f8b7..a27b76f 100644
--- a/drivers/frame_provider/decoder/h264_multi/vmh264.c
+++ b/drivers/frame_provider/decoder/h264_multi/vmh264.c
@@ -4405,10 +4405,7 @@ static int vh264_set_params(struct vdec_h264_hw_s *hw,
 			seq_info2,
 			mb_width,
 			mb_height);
-		WRITE_VREG(AV_SCRATCH_0, (hw->max_reference_size<<24) |
-			(hw->dpb.mDPB.size<<16) |
-			(hw->dpb.mDPB.size<<8));
-		return 0;
+		return -1;
 	}
 
 	if (seq_info2 != 0 &&

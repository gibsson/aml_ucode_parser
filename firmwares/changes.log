commit a607391537c6599e97430c92df1033f3d07f3f3e
Author: Peng Yixin <yixin.peng@amlogic.com>
Date:   Fri Jun 14 10:42:06 2019 +0800

    media_module: Solve the problem of releasing scatter memory slowly [1/1]
    
    PD#SWPL-9473
    
    Problem:
    Due to decoder memory release slowly,
    black screen when hdmi in.
    
    Solution:
    Remove the mechanism of delayed-release memory
    to solve this problem
    
    Verify:
    verified on u212
    
    Change-Id: I51e1d7ad416afabe1132472e5aab4c4744a45f78
    Signed-off-by: Peng Yixin <yixin.peng@amlogic.com>

diff --git a/drivers/frame_provider/decoder/utils/decoder_mmu_box.c b/drivers/frame_provider/decoder/utils/decoder_mmu_box.c
index cc9e7a9..5ab7c16 100644
--- a/drivers/frame_provider/decoder/utils/decoder_mmu_box.c
+++ b/drivers/frame_provider/decoder/utils/decoder_mmu_box.c
@@ -28,6 +28,7 @@
 #include <linux/slab.h>
 #include <linux/amlogic/media/codec_mm/codec_mm_scatter.h>
 #include <linux/platform_device.h>
+
 struct decoder_mmu_box {
 	int max_sc_num;
 	const char *name;
@@ -227,13 +228,13 @@ int decoder_mmu_box_free(void *handle)
 	for (i = 0; i < box->max_sc_num; i++) {
 		sc = box->sc_list[i];
 		if (sc) {
-			codec_mm_scatter_dec_owner_user(sc, 200);
+			codec_mm_scatter_dec_owner_user(sc, 0);
 			box->sc_list[i] = NULL;
 		}
 	}
 	mutex_unlock(&box->mutex);
 	decoder_mmu_box_mgr_del_box(box);
-	codec_mm_scatter_mgt_delay_free_swith(0, 2000, 0, box->tvp_mode);
+	codec_mm_scatter_mgt_delay_free_swith(0, 0, 0, box->tvp_mode);
 	kfree(box);
 	return 0;
 }

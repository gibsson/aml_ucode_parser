commit f222bacf37ba1e49beaadaee2ec9581b9c08565c
Author: Hui Zhang <hui.zhang@amlogic.com>
Date:   Thu Sep 12 12:54:05 2019 +0800

    vh265: fix seek mosaic issue   [1/1]
    
    PD#SWPL-14049
    
    Problem:
    there is mosaic in screeen when ff/ff or seek
    
    Solution:
    not to do error flush until first pic decoded
    
    Verify:
    r314
    
    Change-Id: Idd0499add7040ff5bb059ebdc0db16d6680a4600
    Signed-off-by: Hui Zhang <hui.zhang@amlogic.com>

diff --git a/drivers/frame_provider/decoder/h265/vh265.c b/drivers/frame_provider/decoder/h265/vh265.c
index 02944e6..1229791 100644
--- a/drivers/frame_provider/decoder/h265/vh265.c
+++ b/drivers/frame_provider/decoder/h265/vh265.c
@@ -5877,9 +5877,9 @@ static void check_pic_decoded_error(struct hevc_state_s *hevc,
 				current_lcu_idx,
 				hevc->lcu_x_num*hevc->lcu_y_num);
 			if (((hevc->i_only & 0x4)  == 0) && hevc->cur_pic->POC && ( hevc->cur_pic->slice_type == 0)
-					&& ((hevc->cur_pic->POC + hevc->sps_num_reorder_pics_0) < hevc->iPrevPOC)) {
+					&& ((hevc->cur_pic->POC + MAX_BUF_NUM) < hevc->iPrevPOC)) {
 					hevc_print(hevc, 0,
-					"Flush  .. num_reorder_pic %d  pic->POC %d  hevc->iPrevPOC %d\n",
+					"Flush.. num_reorder_pic %d  pic->POC %d  hevc->iPrevPOC %d\n",
 					hevc->sps_num_reorder_pics_0,hevc->cur_pic->POC ,hevc->iPrevPOC);
 					flush_output(hevc, get_pic_by_POC(hevc, hevc->cur_pic->POC ));
 			}

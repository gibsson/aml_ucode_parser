commit 84bbaed7966b2e048ca8207d2001c1b5f2c7bcc8
Author: Hui Zhang <hui.zhang@amlogic.com>
Date:   Thu Sep 5 19:38:38 2019 +0800

    vmh264: fix frame drop issue in nts [1/1]
    
    PD#SWPL-13465
    
    Problem:
    force di happaned when resolution changed,which
    cause frame drop in nts
    
    Solution:
    disable force di in secure mode
    
    Verify:
    U212
    
    Change-Id: Ie19edacef07c46ac3eb39385b674a1d366c3c3c3
    Signed-off-by: Hui Zhang <hui.zhang@amlogic.com>

diff --git a/drivers/frame_provider/decoder/h264_multi/vmh264.c b/drivers/frame_provider/decoder/h264_multi/vmh264.c
index aa065e5..e9fedd0 100644
--- a/drivers/frame_provider/decoder/h264_multi/vmh264.c
+++ b/drivers/frame_provider/decoder/h264_multi/vmh264.c
@@ -2382,7 +2382,9 @@ static int check_force_interlace(struct vdec_h264_hw_s *hw,
 	struct FrameStore *frame)
 {
 	int bForceInterlace = 0;
-
+	/* no di in secure mode, disable force di */
+	if (vdec_secure(hw_to_vdec(hw)))
+		return 0;
 	if (frame->frame) {
 		if (frame->frame->coded_frame
 			&& !frame->frame->frame_mbs_only_flag) {

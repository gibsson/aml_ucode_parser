commit 8773984960bbdc020f2a1c1047d5bf4e9b4bdbca
Author: Nanxin Qin <nanxin.qin@amlogic.com>
Date:   Mon Jun 17 21:33:35 2019 +0800

    vmh264: fixed playback for the interlace source. [1/1]
    
    PD#OTT-4563
    
    Problem:
    1080i-25-H264.mkv playback failed,no video and audio
    
    Solution:
    fixed playback for the interlace source.
    
    Verify:
    w400
    
    Change-Id: Ie01282e4173b51f62165ebcbbffb0e7f55c58025
    Signed-off-by: Nanxin Qin <nanxin.qin@amlogic.com>

diff --git a/drivers/frame_provider/decoder/h264_multi/vmh264.c b/drivers/frame_provider/decoder/h264_multi/vmh264.c
index e284a98..075ce66 100644
--- a/drivers/frame_provider/decoder/h264_multi/vmh264.c
+++ b/drivers/frame_provider/decoder/h264_multi/vmh264.c
@@ -5552,10 +5552,19 @@ static irqreturn_t vh264_isr_thread_fn(struct vdec_s *vdec, int irq)
 
 		if (p_H264_Dpb->mVideo.dec_picture) {
 			int cfg_ret = 0;
+			bool field_pic_flag = false;
+
 			if (slice_header_process_status == 1) {
-				if ((p_H264_Dpb->mSPS.profile_idc == BASELINE) ||
+				if (!p_H264_Dpb->mSPS.frame_mbs_only_flag) {
+					field_pic_flag =
+						(p_H264_Dpb->mSlice.structure == TOP_FIELD ||
+						p_H264_Dpb->mSlice.structure == BOTTOM_FIELD) ?
+						true : false;
+				}
+
+				if (!field_pic_flag && ((p_H264_Dpb->mSPS.profile_idc == BASELINE) ||
 					(((unsigned long)(hw->vh264_amstream_dec_info
-						.param)) & 0x8)) {
+						.param)) & 0x8))) {
 					p_H264_Dpb->fast_output_enable =
 					H264_OUTPUT_MODE_FAST;
 				}

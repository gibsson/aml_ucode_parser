commit 15d58dc9d68070e1210d71c2b72c6638fc390004
Author: Rui Wang <rui.wang@amlogic.com>
Date:   Fri Jan 11 11:15:27 2019 +0800

    dvb: modify parser source setting algorithms [1/1]
    
    PD#TV-2151
    
    Problem:
    the ts stream cannot be played after
    switch channel
    
    Solution:
    setting parser source according to
    stb_source and demux id
    
    Verify:
    Verify android p at x301
    
    Change-Id: I63438acdcbee37eb5825b0b5c7eb506894fe0526
    Signed-off-by: Rui Wang <rui.wang@amlogic.com>

diff --git a/drivers/stream_input/parser/hw_demux/aml_dmx.c b/drivers/stream_input/parser/hw_demux/aml_dmx.c
index 378d996..ac6747a 100644
--- a/drivers/stream_input/parser/hw_demux/aml_dmx.c
+++ b/drivers/stream_input/parser/hw_demux/aml_dmx.c
@@ -2774,10 +2774,16 @@ static int dmx_enable(struct aml_dmx *dmx)
 		break;
 	}
 
-	if (dmx->channel[0].used || dmx->channel[1].used)
+
+	hi_bsf = 0;
+	if (dmx->id == 0 && dvb->stb_source == AM_TS_SRC_DMX0)
+		hi_bsf = 1;
+
+	if (dmx->id == 1 && dvb->stb_source == AM_TS_SRC_DMX1)
+		hi_bsf = 1;
+
+	if (dmx->id == 2 && dvb->stb_source == AM_TS_SRC_DMX2)
 		hi_bsf = 1;
-	else
-		hi_bsf = 0;
 
 	if ((dvb->dsc[0].dst != -1)
 	    && ((dvb->dsc[0].dst - AM_TS_SRC_DMX0) == dmx->id))

commit fc4c46d64a0a732ccb731bd2c805f307293fef8a
Author: Conglin Guo <conglin.guo@amlogic.com>
Date:   Tue Apr 30 17:24:00 2019 +0800

    media_modules: cts Security Test Cases crash [1/1]
    
    PD#SWPL-7942
    
    Problem:
    cts Security Test Cases crash
    
    Solution:
    1 adjust clock to 100MHZ video Wide*high <= 1280*720
    
    Verify:
    p241
    
    Change-Id: I57440b34a6f5cd7ad5fbca2c20b5af0a3b7dc50f
    Signed-off-by: Conglin Guo <conglin.guo@amlogic.com>

diff --git a/drivers/frame_provider/decoder/h264_multi/vmh264.c b/drivers/frame_provider/decoder/h264_multi/vmh264.c
index 10f2c19..a2cd994 100644
--- a/drivers/frame_provider/decoder/h264_multi/vmh264.c
+++ b/drivers/frame_provider/decoder/h264_multi/vmh264.c
@@ -8661,8 +8661,13 @@ static int ammvdec_h264_probe(struct platform_device *pdev)
 	if (vdec_is_support_4k() ||
 		(clk_adj_frame_count > (VDEC_CLOCK_ADJUST_FRAME - 1)))
 		vdec_source_changed(VFORMAT_H264, 3840, 2160, 60);
-	else
+	else if (pdata->sys_info->height * pdata->sys_info->width <= 1280 * 720)
+	{
+		vdec_source_changed(VFORMAT_H264, 1280, 720, 29);
+	}else
+	{
 		vdec_source_changed(VFORMAT_H264, 1920, 1080, 29);
+	}
 
 	if (vh264_init(hw) < 0) {
 		pr_info("\nammvdec_h264 init failed.\n");
